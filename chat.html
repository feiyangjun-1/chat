<!DOCTYPE html>
<html>
<head>
    <title>智能金额加密工具</title>
    <meta charset="utf-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        body { max-width: 600px; margin: 20px auto; padding: 20px; }
        .input-group { margin-bottom: 15px; }
        #amount { 
            width: 100%;
            padding: 10px;
            border: 2px solid #007bff;
            border-radius: 5px;
            font-size: 16px;
        }
        #preview { 
            margin-top: 10px;
            color: #666;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="input-group">
        <input type="text" id="amount" 
               placeholder="支持输入数字或中文大写（如：5000.00 或 伍仟元整）">
        <div id="preview"></div>
    </div>
    <button onclick="encrypt()" style="width:100%;padding:12px">生成加密字符</button>
    <div id="result" style="margin-top:20px;display:none">
        <p>加密结果：<span id="encryptedResult"></span></p >
        <button onclick="copyResult()">复制结果</button>
    </div>

    <script>
        // 中文大写转数字
        function chineseToNumber(chineseStr) {
            const map = {
                '零':0, '壹':1, '贰':2, '叁':3, '肆':4,
                '伍':5, '陆':6, '柒':7, '捌':8, '玖':9,
                '拾':10, '佰':100, '仟':1000, '万':10000, '亿':100000000
            };
            
            let result = 0;
            let temp = 0;
            let section = 0;
            
            for(let char of chineseStr.replace(/元整?/g, '')){
                const num = map[char];
                if(num < 10){
                    temp = num;
                } else if(num >= 10){
                    temp = temp !== 0 ? temp * num : num;
                    if(num >= 10000){
                        section += temp;
                        result += section * num;
                        section = 0;
                        temp = 0;
                    } else {
                        section += temp;
                        temp = 0;
                    }
                }
            }
            return result + section + temp;
        }

        // 实时输入验证
        document.getElementById('amount').addEventListener('input', function(e){
            const input = e.target.value;
            let number = null;
            
            // 检测中文大写
            if(/[壹贰叁肆伍陆柒捌玖拾佰仟萬亿]/test(input)){
                number = chineseToNumber(input);
                document.getElementById('preview').innerText = `检测到中文大写金额：${number ? number.toFixed(2) : '格式错误'}`;
            } 
            // 检测数字格式
            else if(/(\d+([.,]\d+)?)/.test(input)){
                number = parseFloat(input.replace(/[^\d.]/g, ''));
                document.getElementById('preview').innerText = `标准金额格式：${number.toFixed(2)}`;
            }
        });

        // 加密函数
        function encrypt() {
            let input = document.getElementById('amount').value;
            let amount = null;

            // 自动转换输入内容
            if(/[零壹贰叁肆伍陆柒捌玖拾佰仟萬亿]/.test(input)){
                amount = chineseToNumber(input);
            } else {
                amount = parseFloat(input.replace(/[^\d.]/g, ''));
            }

            if(!amount || isNaN(amount)){
                alert('请输入有效金额');
                return;
            }

            // 执行加密（使用AES）
            const encrypted = CryptoJS.AES.encrypt(
                amount.toFixed(2),
                "your-secret-key-123"
            ).toString();

            document.getElementById('result').style.display = 'block';
            document.getElementById('encryptedResult').textContent = encrypted;
        }

        function copyResult() {
            navigator.clipboard.writeText(document.getElementById('encryptedResult').textContent);
            alert('已复制加密结果');
        }
    </script>
</body>
</html>
